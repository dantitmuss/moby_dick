<!DOCTYPE html>
<html>
<head>
    <!-- Add to <head> of your home.html -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>

    <title>Moby Dick Verse Finder</title>
</head>
<body>
    <h1>Moby Dick Semantic Verse Search</h1>

    <form action="/search" method="post">
        <label for="query">Enter a theme, emotion, or idea:</label><br>
        <input type="text" name="query" id="query" placeholder="e.g., dread, revenge, the sea" required>
        <br><br>
        <button type="submit">Submit</button>
    </form>

    <hr>
    <h2>Or search by tag</h2>

    <form action="/tag_search" method="post">
        <label for="category">Choose a tag category:</label><br>
        <select name="category" id="category" onchange="updateTags()" required>
            <option value="">--Select Category--</option>
            <option value="entities">Entities</option>
            <option value="themes">Themes</option>
            <option value="symbolism">Symbolism</option>
            <option value="feeling">Feeling</option>
            <option value="vibe">Vibe</option>
            <option value="literary_motifs">Literary Motifs</option>
        </select>

        <br><br>

        <label for="tag">Choose a tag:</label><br>
        <input id="tag" name="tag" class="awesomplete" placeholder="Start typing..." required>


        <br><br>
        <button type="submit">Search by Tag</button>
    </form>

    <script>
        let tagsData = {};
    
        // Fetch your tags.json file on page load
        fetch('/tags.json')
            .then(response => response.json())
            .then(data => {
                tagsData = data;
            })
            .catch(error => {
                console.error("Failed to load tags.json:", error);
            });
    
        function updateTags() {
            const categorySelect = document.getElementById("category");
            const tagInput = document.getElementById("tag");
            const selectedCategory = categorySelect.value;
    
            // Clear previous value
            tagInput.value = "";
    
            if (tagsData[selectedCategory]) {
                // Create Awesomplete instance with new tag list
                new Awesomplete(tagInput, {
                    list: tagsData[selectedCategory],
                    minChars: 1,
                    autoFirst: true
                });
            }
        }
    </script>

    
</body>
</html>
